---
import Layout from '../layouts/Layout.astro';

// Mengambil semua file gambar jpg/jpeg di folder public/images
// import.meta.glob biasanya untuk src, tapi kita bisa akali dengan listing manual atau glob aset.
// Di Astro untuk public folder, kita tidak bisa pakai glob server-side standar untuk listing file public di build time dengan mudah tanpa fs.
// TAPI, kita bisa pakai fs (Node.js) karena ini SSG (Static Site Generation).

import fs from 'node:fs';
import path from 'node:path';

const imagesDir = path.join(process.cwd(), 'public/images');
let images = [];

try {
  const files = fs.readdirSync(imagesDir);
  images = files
    .filter(file => /\.(jpg|jpeg|png|webp)$/i.test(file)) // Hanya ambil gambar
    .filter(file => !file.startsWith('logo')) // Jangan masukkan logo ke galeri
    .filter(file => !file.startsWith('hero')) // Jangan masukkan hero
    .map(file => `/bambubos/images/${file}`); // Tambahkan prefix path
} catch (e) {
  console.error("Gagal membaca folder images", e);
}
---

<Layout title="Galeri Proyek BambuBos">
  <section class="bg-stone-900 text-white py-20 px-4 text-center">
    <h1 class="text-4xl md:text-6xl font-bold font-serif mb-4">Galeri Proyek</h1>
    <p class="text-xl text-stone-300 max-w-2xl mx-auto">Dokumentasi hasil pengerjaan Saung, Gazebo, dan Konstruksi Bambu kami.</p>
  </section>

  <section class="container mx-auto px-4 py-16">
    <!-- Grid Masonry-like -->
    <div class="columns-1 md:columns-2 lg:columns-3 gap-8 space-y-8">
      
      {images.map((img) => (
        <div class="break-inside-avoid rounded-xl overflow-hidden shadow-lg group bg-stone-100 mb-8">
          <img 
            src={img} 
            alt="Dokumentasi Proyek BambuBos" 
            class="w-full h-auto hover:scale-105 transition duration-500" 
            loading="lazy"
            onerror="this.style.display='none'" 
          />
        </div>
      ))}

    </div>
  </section>
</Layout>